import{S as m,A as y,d as h,e as f,U as g}from"./index-78ab82dd.js";const v=m("user",{persist:{key:"user",storage:localStorage,paths:["user"]},state:()=>({user:{name:"",neigborhood:"",address:"",phone_number:"",payment_method_option:""}}),getters:{fucion:e=>0},actions:{async func(){return func}}}),n=y(),o=h(),s=v(),S=()=>{var a,i,d,u;const e=n.cart.products.map(t=>({product_instance_id:t.product.id,quantity:t.quantity})),r=n.cart.additions.map(t=>({aditional_item_instance_id:t.id,quantity:t.quantity})),c=o.location.site.site_id,_=o.location.neigborhood.delivery_price,l=n.cart.order_notes,p={user_name:s.user.name,user_phone:(a=s.user.phone_number)==null?void 0:a.split(" ").join(""),user_address:` ${s.user.address} ${(d=(i=o.location)==null?void 0:i.neigborhood)==null?void 0:d.name}`||""};return{order_products:e,site_id:c,delivery_person_id:4,payment_method_id:(u=s.user.payment_method_option)==null?void 0:u.id,delivery_price:_,order_notes:l||"SIN NOTAS",user_data:p,order_aditionals:r}},w={async sendOrder(){const e=S();if(!A(e))return null;try{const r=await f.post(`${g}/order`,e);if(r.status!==200)return console.error("An error occurred while sending the order:",r.status),alert("An error occurred while sending the order. Please try again."),null}catch(r){return console.error("An error occurred while sending the order:",r),alert("An error occurred while sending the order. Please check your internet connection and try again."),null}}};function A(e){return e.order_products.every(r=>r.product_instance_id&&r.quantity)?!e.user_data.user_name||e.user_data.user_name.trim()==""||!e.user_data.user_phone||e.user_data.user_phone.trim()==""||!e.user_data.user_address||e.user_data.user_address.trim()==""?(alert("Sus datos estan incompletos por favor reviselos"),!1):!e.site_id||!e.delivery_price?(alert("Site information is missing. Please select a valid site."),!1):!0:(alert("Some products in your cart are missing details."),!1)}export{w as o,v as u};
