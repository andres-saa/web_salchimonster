import{d as n,D as l,U as i}from"./index-3ce4ae70.js";const u=n({}),a=n(""),h=n(!1),g=JSON.parse(localStorage.getItem("currentNeigborhood")).currenNeigborhood.name,p=async r=>{const t=`${i}/user`;r.user_address=`${r.user_address} ${g} `,console.log(r);const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};try{const e=await fetch(t,s);if(!e.ok)throw new Error(`Error en la solicitud para obtener user_id: ${e.status}`);return(await e.json()).user_id}catch(e){throw console.error("Error al obtener user_id:",e),e}},m=async()=>{const r=u.value;r.site_id=JSON.parse(localStorage.getItem("currentNeigborhood")).currenSiteId;const t=await p(r),s={order_products:JSON.parse(localStorage.getItem("cart")).products,user_id:t,site_id:JSON.parse(localStorage.getItem("currentNeigborhood")).currenSiteId,order_status:{status:"generada",timestamp:new Date().toLocaleString()},payment_method:"Efectivo",delivery_person_id:4,status_history:[{}],delivery_price:l.value.deliveryPrice,order_notes:a.value==null||a.value==""?"sin notas":a.value};let e="POST";const c=`${i}/order`,d={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};await fetch(c,d).then(o=>{if(!o.ok)throw new Error(`Error en la solicitud: ${o.status}`);return o.json()}).then(o=>{console.log("Datos actualizados:",o),localStorage.removeItem("cart"),h.value=!0}).catch(o=>{console.error("Error en la solicitud:",o)})};export{m as a,a as o,h as s,u};
