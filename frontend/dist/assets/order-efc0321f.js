import{d as t,D as l,U as i}from"./index-bd1f107b.js";const u=t({}),n=t(""),h=t(!1),g=JSON.parse(localStorage.getItem("currentNeigborhood")).currenNeigborhood.name,p=t(""),m=t(["Recoger en local","Efectivo","Pago con tarjeta (datafono),"]),_=async o=>{const s=`${i}/user`;o.user_address=`${o.user_address} ${g} `,console.log(o);const a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)};try{const e=await fetch(s,a);if(!e.ok)throw new Error(`Error en la solicitud para obtener user_id: ${e.status}`);return(await e.json()).user_id}catch(e){throw console.error("Error al obtener user_id:",e),e}},S=async()=>{const o=u.value;o.site_id=JSON.parse(localStorage.getItem("currentNeigborhood")).currenSiteId;const s=await _(o),a={order_products:JSON.parse(localStorage.getItem("cart")).products,user_id:s,site_id:JSON.parse(localStorage.getItem("currentNeigborhood")).currenSiteId,order_status:{status:"generada",timestamp:new Date().toLocaleString()},payment_method:p.value,delivery_person_id:4,status_history:[{}],delivery_price:l.value.deliveryPrice,order_notes:n.value==null||n.value==""?"sin notas":n.value};let e="POST";const c=`${i}/order`,d={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};await fetch(c,d).then(r=>{if(!r.ok)throw new Error(`Error en la solicitud: ${r.status}`);return r.json()}).then(r=>{console.log("Datos actualizados:",r),localStorage.removeItem("cart"),h.value=!0}).catch(r=>{console.error("Error en la solicitud:",r)})};export{m as a,S as b,n as o,p,h as s,u};
