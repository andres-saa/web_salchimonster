import{_ as q,j as G,e as O,k as l,l as W,g as Y,w as y,U as C,m as K,r as m,o as D,c as k,b as o,a as i,d as r,F as Q,i as X,n as T,p as g,T as Z,q as ee,h as R,t as S,s as te,v as oe}from"./index-df1f671e.js";import{s as se}from"./valoresReactivosCompartidos-f7d03a62.js";import{u as ae}from"./reportes-d8b241e8.js";const le=x=>(te("data-v-ca16496b"),x=x(),oe(),x),ne={class:"col-12 px-3 md:px-4 mx-auto",style:{position:"relative","max-width":"900px","margin-top":"6rem"}},ie={class:"grid",style:{"background-color":"rgba(250, 250, 250, 0)"}},re={class:"text-sm col-12 md:col-3 p-2 xl:col-2"},ce={class:"text-center col-12 p-2 md:col-3"},de={class:"col-12 md:col-1 md:p-0",style:{display:"flex","align-items":"center","justify-content":"start"}},pe=le(()=>o("p",{class:"text-3xl px-0 mx-0 my-6 pb-0",style:{"font-weight":"bold"}},[o("i",{class:"fa-solid fa-chart-simple"}),R(" Vision General")],-1)),ue={class:"contenedor mt-5",style:{position:"sticky",top:"3rem","z-index":"99"}},me={class:"col-12 px-0 py-0 my-0 p-0",style:{"overflow-x":"auto","background-color":"#fafafa"}},fe={class:"px-0 mx-0",style:{width:"max-content","background-color":"#fafafa",display:"flex",color:"","justify-content":"start",gap:"2rem","min-width":"max-content"}},ve={style:{"background-color":""}},_e={class:"grid p-0 m-0"},ye={class:"grid"},ge={class:"col-12 px-0 mx-0"},xe={class:"col-12",style:{display:"flex","flex-direction":"column"}},he={class:"text-l",style:{"font-weight":"bold"}},be={class:"col-12",style:{display:"flex","flex-direction":"column"}},we={style:{"font-weight":"bold"},class:"text-l"},De={class:"col-12 p-0",style:{display:"flex","justify-content":"center"}},ke={class:"col-12",style:{display:"flex","justify-content":"center"}},Se={__name:"reporteVentas",setup(x){const s=ae(),{isDarkTheme:j}=G(),E=O(),I=l(["enviada","cancelada","en preparacion"]),L=l("enviada"),N=W(),U=l([]),F=l([E.site]),f=l(!1),h=l(new Date(new Date().setDate(new Date().getDate()-7))),b=l(new Date),u=l(new Date),c=l(new Date);l("");function _(t){const e=new Date,d=new Date(e);d.setDate(d.getDate()+1);const p=new Date(e);p.setDate(e.getDate()-t),u.value=p,t==1?(c.value=e,s.setDateRange(u.value,c.value),f.value=!1):(c.value=d,s.setDateRange(u.value,c.value),f.value=!1),s.fetchSalesReport()}Y(()=>{z().then(t=>{U.value=t,s.setSelectedSites(F.value)}),s.fetchSalesReport()});const B=async()=>{const t=v(h.value),e=v(b.value),d=new URLSearchParams({site_ids:[],status:L.value,start_date:t,end_date:e}),p=`${C}/sales_report?${d.toString()}`;try{const n=await fetch(p,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const w=await n.json();se.value=w,console.log(w)}catch(n){console.error("Fetch error:",n)}};y([h,b],()=>{B()},{deep:!0}),y(()=>s.order_status,(t,e)=>{console.log(`El estado de orden ha cambiado de ${e} a ${t}`),s.fetchSalesReport()}),y(s.selectedSites,t=>{s.setSelectedSites(t)},{deep:!0});const z=async()=>{try{const t=await fetch(`${C}/sites`);if(!t.ok)throw"paila";return await t.json()}catch(t){console.log(t)}},A=l([{name:"Valor ventas",to:"valor-ventas",icon:"fa-solid fa-dollar-sign"},{name:"Ordenes",to:"ordenes",icon:"fa-solid fa-table"}]);l(null),K({labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,backgroundColor:"#00bb7e",borderColor:"#00bb7e",tension:.4}]}),l([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const V=l(null),M=()=>{V.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},P=()=>{V.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}};y(j,t=>{t?P():M()},{immediate:!0}),l(`${h.value} - ${b.value}`);function v(t){const e=new Date(t),d=e.getFullYear(),p=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0");return`${d}-${p}-${n}`}return l({}),l(),y([u,c],([t,e])=>{t>e&&(alert("La fecha de inicio debe ser anterior o igual a la fecha final."),c.value=t)}),(t,e)=>{const d=m("Dropdown"),p=m("InputText"),n=m("Button"),w=m("RouterLink"),H=m("RouterView"),$=m("Calendar"),J=m("Dialog");return D(),k("div",ne,[o("div",ie,[o("div",re,[i(d,{class:"text-sm col-12 p-0",style:{height:"2.7rem"},modelValue:r(s).order_status,"onUpdate:modelValue":e[0]||(e[0]=a=>r(s).order_status=a),options:I.value,placeholder:"Estado"},null,8,["modelValue","options"])]),o("div",ce,[i(p,{class:"col-12 p-3",onClick:e[1]||(e[1]=a=>f.value=!0),style:{height:"2.7rem"},value:r(s).dateRangeDifference.rangeName||`${v(r(s).dateRange.startDate)}  |  ${v(r(s).dateRange.endDate)}`,placeholder:"periodo"},null,8,["value"])]),o("div",de,[i(n,{icon:"pi pi-search",severity:"help",class:"text-center p-0 col-12 md:p-0",style:{height:"2.5rem",width:"min-content","aspect-ratio":"1 / 1","font-weight":"bold","border-radius":"50%",display:"flex","justify-content":"center"},onClick:r(s).fetchSalesReport},null,8,["onClick"])])]),pe,o("div",ue,[o("div",me,[o("div",fe,[(D(!0),k(Q,null,X(A.value,a=>(D(),k("div",ve,[i(w,{to:`/reporte-ventas/${a.to}`},{default:g(()=>[i(n,{size:"medium",style:ee([r(N).path.includes(a.to)?"box-shadow: 0 4px 0 #ff6200;color:#000;font-weight:bold;":"",{"border-radius":"0",transition:".3s all ease"}]),class:"text-md px-0 pt-2 pb-4 my-0 mx-0",text:"",severity:"secondary"},{default:g(()=>[o("i",{class:T(["mr-2",a.icon])},null,2),R(" "+S(a.name)+" ",1)]),_:2},1032,["style"])]),_:2},1032,["to"])]))),256))])])]),o("div",_e,[o("div",{class:T(["p-0",r(s).visibleNotifications?"col-9":"col-12"])},[i(Z,{name:"fade"},{default:g(()=>[i(H)]),_:1})],2)]),i(J,{visible:f.value,"onUpdate:visible":e[10]||(e[10]=a=>f.value=a),modal:"",header:"Periodo",style:{width:"25rem"}},{default:g(()=>[o("div",ye,[o("div",ge,[i(n,{text:"",label:"Hoy",onClick:e[2]||(e[2]=a=>_(0)),class:"p-button-text col-12 p-1 m-0"}),i(n,{text:"",label:"Ayer",onClick:e[3]||(e[3]=a=>_(1)),class:"p-button-text col-12 p-1 m-0"}),i(n,{text:"",label:"Últimos 7 días",onClick:e[4]||(e[4]=a=>_(7)),class:"p-button-text col-12 p-1 m-0"}),i(n,{text:"",label:"Últimos 14 días",onClick:e[5]||(e[5]=a=>_(14)),class:"p-button-text col-12 p-1"}),i(n,{text:"",label:"Últimos 28 días",onClick:e[6]||(e[6]=a=>_(28)),class:"p-button-text col-12 p-0"})]),o("div",xe,[o("span",he,"Desde - "+S(v(h.value)),1),i($,{style:{"min-width":"max-content"},modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=a=>u.value=a)},null,8,["modelValue"])]),o("div",be,[o("span",we,"Hasta - "+S(v(b.value)),1),i($,{style:{"min-width":"max-content"},modelValue:c.value,"onUpdate:modelValue":e[8]||(e[8]=a=>c.value=a),showWeek:""},null,8,["modelValue"])]),o("div",De,[o("div",ke,[i(n,{onClick:e[9]||(e[9]=()=>{r(s).setDateRange(u.value,c.value),f.value=!1,r(s).fetchSalesReport()})},{default:g(()=>[R("Aplicar")]),_:1})])])])]),_:1},8,["visible"])])}}},Ce=q(Se,[["__scopeId","data-v-ca16496b"]]);export{Ce as default};
