import{r as p,o as h,c as D,b as s,t as u,a as o,i as m,f as $,U as x,j as k,k as C,w as r,F,l as S}from"./index-c40d40a4.js";const M={class:"col-12",v:"",style:{display:"flex","flex-direction":"column","pointer-events":"none","align-items":"center","justify-content":"center",position:"fixed","z-index":"10000",left:"0",top:"0",height:"100%","background-color":"rgba(0, 0, 0, 0.5)"}},N={class:"text-3xl",style:{"font-weight":"bold","text-transform":"uppercase",color:"white","text-shadow":"0 0 10px rgba(0, 0, 0, 0.551)"}},O={style:{display:"flex"}},L={__name:"Loading",props:{tittle:{type:String,default:"CARGANDO"}},setup(w){const l=w;return(f,b)=>{const d=p("ProgressSpinner");return h(),D("div",M,[s("p",N,u(l.tittle),1),s("div",O,[o(d,{style:{width:"100px",height:"100px"},strokeWidth:"4",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])])}}},U=s("p",{class:"text-center my-6 text-4xl",style:{"font-weight":"bold"}}," Horario",-1),j={class:"m-auto p-0",style:{"max-width":"600px"}},B=s("span",{class:"p-column-title"},"Code",-1),E=s("span",{class:"p-column-title"},"Code",-1),A=s("span",{class:"p-column-title"},"Code",-1),I={class:"col-12 p-2 m-0",style:{display:"flex",gap:"1rem","justify-content":"end"}},H={class:"m-auto p-0",style:{"max-width":"600px"}},G=s("span",{class:"p-column-title"},"Code",-1),z=s("span",{class:"p-column-title"},"Code",-1),J=["disabled"],K=s("span",{class:"p-column-title"},"Code",-1),W=["disabled"],q={class:"col-12 p-0 mt-5",style:{display:"flex","justify-content":"end"}},X={__name:"horarios",setup(w){const l=m(!1);function f(n){var t=n.getHours(),e=n.getMinutes(),i=t>=12?"PM":"AM";t=t%12,t=t||12;var c=t+":"+e.toString().padStart(2,"0")+" "+i;return c}const b=()=>{l.value=!0},d=m(!1),_=m([]),g=m(!1);$(()=>{localStorage.getItem("siteId"),T().then(n=>_.value=n)});const T=async()=>{g.value=!0;const n=localStorage.getItem("siteId");try{const t=await fetch(`${x}/site-schedule/${n}/`);if(!t.ok)throw"paila";const e=await t.json();return e.forEach(i=>{i.opening_time=new Date(`1970-01-01T${i.opening_time}`),i.closing_time=new Date(`1970-01-01T${i.closing_time}`)}),g.value=!1,e}catch(t){g.value=!1,console.log(t)}},V=async()=>{d.value=!0;try{const n=_.value.map(e=>{const i=e.opening_time instanceof Date?e.opening_time.toLocaleTimeString():e.opening_time,c=e.closing_time instanceof Date?e.closing_time.toLocaleTimeString():e.closing_time;return{...e,opening_time:i.split(" ")[0],closing_time:c.split(" ")[0]}});if(!(await fetch(`${x}/site-schedule/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw"Error al enviar los datos";l.value=!1,d.value=!1}catch(n){console.log(n),d.value=!1}},P=m(["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"]);return(n,t)=>{const e=p("Column"),i=p("Calendar"),c=p("DataTable"),y=p("Button"),R=p("Dialog");return h(),D(F,null,[d.value?(h(),k(L,{key:0,tittle:"guardando"})):C("",!0),g.value?(h(),k(L,{key:1,tittle:"cargando horario"})):C("",!0),U,o(R,{visible:l.value,"onUpdate:visible":t[1]||(t[1]=a=>l.value=a),style:{width:"30rem"},modal:""},{footer:r(()=>[s("div",I,[o(y,{outlined:"",severity:"danger",onClick:t[0]||(t[0]=a=>l.value=!1),style:{"font-weight":"bold","border-radius":"0.3rem"},class:"m-0",label:"Cancelar"}),o(y,{severity:"success",onClick:V,style:{"font-weight":"bold","border-radius":"0.3rem"},class:"m-0",label:"Guardar"})])]),default:r(()=>[s("div",j,[o(c,{ref:"dt",class:"p-0",value:_.value,dataKey:"id",style:{border:"1rem",overflow:"hidden"},rows:7,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} scheldules",responsiveLayout:"scroll",scrollable:"","scroll-height":"62vh"},{default:r(()=>[o(e,{class:"p-2",field:"day_of_week",header:"Dia",headerStyle:"width:5rem; min-width:5rem; "},{body:r(a=>[B,S(" "+u(P.value[a.data.day_of_week-1]),1)]),_:1}),o(e,{class:"p-2",field:"opening_time",header:"Apertura",headerStyle:"width:5rem; min-width:5rem;"},{body:r(a=>[E,o(i,{disabled:!l.value,hourFormat:"12",timeOnly:"",modelValue:a.data.opening_time,"onUpdate:modelValue":v=>a.data.opening_time=v},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1}),o(e,{class:"p-2",field:"closing_time",header:"Cierre",headerStyle:"width:5rem; min-width:3rem;"},{body:r(a=>[A,o(i,{disabled:!l.value,hourFormat:"12",timeOnly:"",modelValue:a.data.closing_time,"onUpdate:modelValue":v=>a.data.closing_time=v},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value"])])]),_:1},8,["visible"]),s("div",H,[o(c,{showGridlines:"",ref:"dt",class:"p-0",value:_.value,dataKey:"id",style:{border:"1rem",overflow:"hidden"},rows:7,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} scheldules",responsiveLayout:"scroll",scrollable:"","scroll-height":"62vh"},{default:r(()=>[o(e,{class:"p-2",field:"day_of_week",header:"Dia",headerStyle:"width:2rem;"},{body:r(a=>[G,S(" "+u(P.value[a.data.day_of_week-1]),1)]),_:1}),o(e,{class:"p-2",field:"opening_time",header:"Apertura",headerStyle:"width:2rem"},{body:r(a=>[z,s("span",{disabled:!l.value,hourFormat:"12",timeOnly:""},u(f(a.data.opening_time)),9,J)]),_:1}),o(e,{class:"p-2",field:"closing_time",header:"Cierre",headerStyle:"width:2rem;"},{body:r(a=>[K,s("span",{disabled:!l.value,hourFormat:"12",timeOnly:""},u(f(a.data.closing_time)),9,W)]),_:1})]),_:1},8,["value"]),s("div",q,[o(y,{severity:"danger",onClick:b,size:"small",label:"Modificar El horario",class:"m-0 mb-3",style:{"font-weight":"bold","border-radius":"0.3rem"}})])])],64)}}};export{X as default};
