import{r as p,o as f,c as D,b as s,t as g,a,k as m,g as $,U as P,x as k,y as C,p as r,F,h as S}from"./index-01b17d03.js";const M={class:"col-12",v:"",style:{display:"flex","flex-direction":"column","pointer-events":"none","align-items":"center","justify-content":"center",position:"fixed","z-index":"10000",left:"0",top:"0",height:"100%","background-color":"rgba(0, 0, 0, 0.5)"}},N={class:"text-3xl",style:{"font-weight":"bold","text-transform":"uppercase",color:"white","text-shadow":"0 0 10px rgba(0, 0, 0, 0.551)"}},O={style:{display:"flex"}},L={__name:"Loading",props:{tittle:{type:String,default:"CARGANDO"}},setup(w){const l=w;return(y,b)=>{const d=p("ProgressSpinner");return f(),D("div",M,[s("p",N,g(l.tittle),1),s("div",O,[a(d,{style:{width:"100px",height:"100px"},strokeWidth:"4",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])])}}},U=s("p",{class:"text-center my-6 text-4xl",style:{"font-weight":"bold"}}," Horario",-1),E={class:"m-auto p-0",style:{"max-width":"600px"}},B=s("span",{class:"p-column-title"},"Code",-1),j=s("span",{class:"p-column-title"},"Code",-1),A=s("span",{class:"p-column-title"},"Code",-1),I={class:"col-12 p-2 m-0",style:{display:"flex",gap:"1rem","justify-content":"end"}},H={class:"m-auto p-0",style:{"max-width":"600px"}},G=s("span",{class:"p-column-title"},"Code",-1),z=s("span",{class:"p-column-title"},"Code",-1),J=["disabled"],K=s("span",{class:"p-column-title"},"Code",-1),W=["disabled"],q={class:"col-12 p-0 mt-5",style:{display:"flex","justify-content":"end"}},X={__name:"horarios",setup(w){const l=m(!1);function y(i){var t=i.getHours(),e=i.getMinutes(),n=t>=12?"PM":"AM";t=t%12,t=t||12;var c=t+":"+e.toString().padStart(2,"0")+" "+n;return c}const b=()=>{l.value=!0},d=m(!1),_=m([]),h=m(!1);$(()=>{localStorage.getItem("siteId"),T().then(i=>_.value=i)});const T=async()=>{h.value=!0;const i=localStorage.getItem("siteId");try{const t=await fetch(`${P}/site-schedule/${i}/`);if(!t.ok)throw"paila";const e=await t.json();return e.forEach(n=>{n.opening_time=new Date(`1970-01-01T${n.opening_time}`),n.closing_time=new Date(`1970-01-01T${n.closing_time}`)}),h.value=!1,e}catch(t){h.value=!1,console.log(t)}},V=async()=>{d.value=!0;try{const i=_.value.map(e=>{const n={hour12:!1,hour:"2-digit",minute:"2-digit"},c=e.opening_time instanceof Date?e.opening_time.toLocaleTimeString([],n):e.opening_time,u=e.closing_time instanceof Date?e.closing_time.toLocaleTimeString([],n):e.closing_time;return{...e,opening_time:c,closing_time:u}});if(!(await fetch(`${P}/site-schedule/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok)throw new Error("Error al enviar los datos");l.value=!1,d.value=!1}catch(i){console.log(i),d.value=!1}},x=m(["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"]);return(i,t)=>{const e=p("Column"),n=p("Calendar"),c=p("DataTable"),u=p("Button"),R=p("Dialog");return f(),D(F,null,[d.value?(f(),k(L,{key:0,tittle:"guardando"})):C("",!0),h.value?(f(),k(L,{key:1,tittle:"cargando horario"})):C("",!0),U,a(R,{visible:l.value,"onUpdate:visible":t[1]||(t[1]=o=>l.value=o),style:{width:"30rem"},modal:""},{footer:r(()=>[s("div",I,[a(u,{outlined:"",severity:"danger",onClick:t[0]||(t[0]=o=>l.value=!1),style:{"font-weight":"bold","border-radius":"0.3rem"},class:"m-0",label:"Cancelar"}),a(u,{severity:"success",onClick:V,style:{"font-weight":"bold","border-radius":"0.3rem"},class:"m-0",label:"Guardar"})])]),default:r(()=>[s("div",E,[a(c,{ref:"dt",class:"p-0",value:_.value,dataKey:"id",style:{border:"1rem",overflow:"hidden"},rows:7,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} scheldules",responsiveLayout:"scroll",scrollable:"","scroll-height":"62vh"},{default:r(()=>[a(e,{class:"p-2",field:"day_of_week",header:"Dia",headerStyle:"width:5rem; min-width:5rem; "},{body:r(o=>[B,S(" "+g(x.value[o.data.day_of_week-1]),1)]),_:1}),a(e,{class:"p-2",field:"opening_time",header:"Apertura",headerStyle:"width:5rem; min-width:5rem;"},{body:r(o=>[j,a(n,{disabled:!l.value,hourFormat:"12",timeOnly:"",modelValue:o.data.opening_time,"onUpdate:modelValue":v=>o.data.opening_time=v},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1}),a(e,{class:"p-2",field:"closing_time",header:"Cierre",headerStyle:"width:5rem; min-width:3rem;"},{body:r(o=>[A,a(n,{disabled:!l.value,hourFormat:"12",timeOnly:"",modelValue:o.data.closing_time,"onUpdate:modelValue":v=>o.data.closing_time=v},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value"])])]),_:1},8,["visible"]),s("div",H,[a(c,{showGridlines:"",ref:"dt",class:"p-0",value:_.value,dataKey:"id",style:{border:"1rem",overflow:"hidden"},rows:7,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} scheldules",responsiveLayout:"scroll",scrollable:"","scroll-height":"62vh"},{default:r(()=>[a(e,{class:"p-2",field:"day_of_week",header:"Dia",headerStyle:"width:2rem;"},{body:r(o=>[G,S(" "+g(x.value[o.data.day_of_week-1]),1)]),_:1}),a(e,{class:"p-2",field:"opening_time",header:"Apertura",headerStyle:"width:2rem"},{body:r(o=>[z,s("span",{disabled:!l.value,hourFormat:"12",timeOnly:""},g(y(o.data.opening_time)),9,J)]),_:1}),a(e,{class:"p-2",field:"closing_time",header:"Cierre",headerStyle:"width:2rem;"},{body:r(o=>[K,s("span",{disabled:!l.value,hourFormat:"12",timeOnly:""},g(y(o.data.closing_time)),9,W)]),_:1})]),_:1},8,["value"]),s("div",q,[a(u,{severity:"danger",onClick:b,size:"small",label:"Modificar El horario",class:"m-0 mb-3",style:{"font-weight":"bold","border-radius":"0.3rem"}})])])],64)}}};export{X as default};
