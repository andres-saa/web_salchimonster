import{d as i,D as l,U as c}from"./index-4db8c5e6.js";const u=i({}),a=i(""),g=JSON.parse(localStorage.getItem("currentNeigborhood")).currenNeigborhood.name,h=async r=>{const t=`${c}/user`;r.user_address=`${r.user_address} ${g} `,console.log(r);const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};try{const e=await fetch(t,s);if(!e.ok)throw new Error(`Error en la solicitud para obtener user_id: ${e.status}`);return(await e.json()).user_id}catch(e){throw console.error("Error al obtener user_id:",e),e}},_=async()=>{const r=u.value;r.site_id=JSON.parse(localStorage.getItem("currentNeigborhood")).currenSiteId;const t=await h(r),s={order_products:JSON.parse(localStorage.getItem("cart")).products,user_id:t,site_id:JSON.parse(localStorage.getItem("currentNeigborhood")).currenSiteId,order_status:{status:"generada",timestamp:new Date().toLocaleString()},payment_method:"Efectivo",delivery_person_id:4,status_history:[{}],delivery_price:l.value.deliveryPrice,order_notes:a.value==null||a.value==""?"sin notas":a.value};let e="POST";const n=`${c}/order`,d={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};await fetch(n,d).then(o=>{if(!o.ok)throw new Error(`Error en la solicitud: ${o.status}`);return o.json()}).then(o=>{console.log("Datos actualizados:",o),localStorage.removeItem("cart"),location.reload()}).catch(o=>{console.error("Error en la solicitud:",o)})};export{a as o,_ as s,u};
