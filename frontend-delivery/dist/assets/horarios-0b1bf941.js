import{r as u,a as g,c as C,e as s,t as P,b as o,d as p,o as L,U as w,m as b,n as x,w as r,F as $,k as f}from"./index-e68cbcf7.js";const N={class:"col-12",v:"",style:{display:"flex","flex-direction":"column","pointer-events":"none","align-items":"center","justify-content":"center",position:"fixed","z-index":"10000",left:"0",top:"0",height:"100%","background-color":"rgba(0, 0, 0, 0.5)"}},U={class:"text-3xl",style:{"font-weight":"bold","text-transform":"uppercase",color:"white","text-shadow":"0 0 10px rgba(0, 0, 0, 0.551)"}},B={style:{display:"flex"}},k={__name:"Loading",props:{tittle:{type:String,default:"CARGANDO"}},setup(y){const l=y;return(v,d)=>{const c=u("ProgressSpinner");return g(),C("div",N,[s("p",U,P(l.tittle),1),s("div",B,[o(c,{style:{width:"100px",height:"100px"},strokeWidth:"4",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])])}}},R=s("p",{class:"text-center my-6 text-4xl",style:{"font-weight":"bold"}}," Horario",-1),E={class:"m-auto p-2",style:{"max-width":"600px","box-shadow":"0 0 20px rgba(0, 0, 0, 0.31)","border-radius":"1rem"}},F=s("span",{class:"p-column-title"},"Code",-1),M=s("span",{class:"p-column-title"},"Code",-1),O=s("span",{class:"p-column-title"},"Code",-1),j={class:"col-12",style:{display:"flex","justify-content":"end"}},I={__name:"horarios",setup(y){const l=p(!1),v=()=>{l.value=!0},d=p(!1),c=p([]),m=p(!1);L(()=>{S().then(a=>c.value=a)});const S=async()=>{m.value=!0;const a=localStorage.getItem("siteId");try{const i=await fetch(`${w}/site-schedule/${a}/`);if(!i.ok)throw"paila";const e=await i.json();return e.forEach(t=>{t.opening_time=new Date(`1970-01-01T${t.opening_time}`),t.closing_time=new Date(`1970-01-01T${t.closing_time}`)}),m.value=!1,e}catch(i){m.value=!1,console.log(i)}},T=async()=>{d.value=!0;try{const a=c.value.map(e=>{const t=e.opening_time instanceof Date?e.opening_time.toLocaleTimeString():e.opening_time,_=e.closing_time instanceof Date?e.closing_time.toLocaleTimeString():e.closing_time;return{...e,opening_time:t.split(" ")[0],closing_time:_.split(" ")[0]}});if(!(await fetch(`${w}/site-schedule/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw"Error al enviar los datos";l.value=!1,d.value=!1}catch(a){console.log(a),d.value=!1}},V=p(["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"]);return(a,i)=>{const e=u("Button"),t=u("Column"),_=u("Calendar"),D=u("DataTable");return g(),C($,null,[d.value?(g(),b(k,{key:0,tittle:"guardando"})):x("",!0),m.value?(g(),b(k,{key:1,tittle:"cargando horario"})):x("",!0),R,s("div",E,[o(e,{onClick:v,size:"small",class:"m-3",outlined:"",style:{"font-weight":"bold","border-radius":"0.5rem"}},{default:r(()=>[f("Modificar")]),_:1}),o(D,{ref:"dt",class:"p-5",value:c.value,dataKey:"id",style:{border:"1rem",overflow:"hidden"},rows:7,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} scheldules",responsiveLayout:"scroll",scrollable:"","scroll-height":"62vh"},{default:r(()=>[o(t,{class:"p-2",field:"day_of_week",header:"Dia",headerStyle:"width:5rem; min-width:5rem; "},{body:r(n=>[F,f(" "+P(V.value[n.data.day_of_week-1]),1)]),_:1}),o(t,{class:"p-2",field:"opening_time",header:"Apertura",headerStyle:"width:5rem; min-width:5rem;"},{body:r(n=>[M,o(_,{disabled:!l.value,hourFormat:"12",timeOnly:"",modelValue:n.data.opening_time,"onUpdate:modelValue":h=>n.data.opening_time=h},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1}),o(t,{class:"p-2",field:"closing_time",header:"Cierre",headerStyle:"width:5rem; min-width:5rem;"},{body:r(n=>[O,o(_,{disabled:!l.value,hourFormat:"12",timeOnly:"",modelValue:n.data.closing_time,"onUpdate:modelValue":h=>n.data.closing_time=h},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value"]),s("div",j,[o(e,{onClick:T,style:{"font-weight":"bold","border-radius":"0.5rem"},class:""},{default:r(()=>[f("Guardar")]),_:1})])])],64)}}};export{I as default};
